System.register(["./element-plus-legacy-DNfkhTo6.js","./index-legacy-CsQSZUd7.js","./@vue-legacy-CFIgPWJL.js","./xlsx-legacy-Fel5d1ua.js","./@element-plus-legacy-DlQcNsEd.js","./@ctrl-legacy-BxnR6uzU.js","./@vueuse-legacy-CtZxvhJE.js","./lodash-es-legacy-Dfu271Ug.js","./@popperjs-legacy-CtArNnFZ.js","./vue-router-legacy-BlnIwtyT.js","./path-browserify-legacy-DckvunJI.js","./dayjs-legacy-Dm4tvPOc.js","./default-passive-events-legacy-vxSn0DcW.js"],(function(e,l){"use strict";var a,t,n,o,s,i,c,u,d,r,f,p,g,m,h,y,v,b,x,_,j,w,C,k,S,N,E,V;return{setters:[e=>{a=e.d,t=e.e,n=e.f,o=e.g,s=e.h,i=e.i},e=>{c=e._},e=>{u=e.r,d=e.w,r=e.a2,f=e.o,p=e.M,g=e.O,m=e.a,h=e.L,y=e._,v=e.u,b=e.c,x=e.J,_=e.a3,j=e.W,w=e.P,C=e.z,k=e.aa,S=e.ab},e=>{N=e.r,E=e.u,V=e.w},null,null,null,null,null,null,null,null,null],execute:function(){var l=document.createElement("style");l.textContent=".file-list[data-v-d1d46af9]{margin-top:8px}.file-list .file-box[data-v-d1d46af9]{display:flex;align-items:center;justify-content:space-between;line-height:24px}.file-list .file-box .icon-del[data-v-d1d46af9]{cursor:pointer}.file-list .file-box .icon-del[data-v-d1d46af9]:hover{color:#f60}.container[data-v-403fb5f1]{padding:16px}.card[data-v-403fb5f1]{text-align:center}.card .tip[data-v-403fb5f1]{margin-top:16px;color:#666}.card .sheet-list[data-v-403fb5f1]{padding-top:16px;display:flex;justify-content:center;flex-wrap:wrap}.card .sheet-list .sheet-item[data-v-403fb5f1]{margin:8px;cursor:pointer;color:#409eff}\n",document.head.appendChild(l);const B=(e=>(k("data-v-d1d46af9"),e=e(),S(),e))((()=>m("p",null,"将文件拖到此处或点击上传",-1))),H={key:0,class:"file-list"},O={class:"dialog-footer"},D=Object.assign({name:"UploadDialog"},{__name:"UploadDialog",props:{dialogVisible:{type:Boolean,default:!1},width:{type:[String,Number],default:"500"},title:{type:String,default:"上传"},modal:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},multiple:{type:Boolean,default:!0},limit:{type:Number,default:3},accept:{type:[String,Array],default:".xls,.xlsx"},loading:{type:Boolean,default:!1}},emits:["on-confirm","on-cancel"],setup(e,{emit:l}){const i=e,c=l,k=u(!1),S=u([]),N=u(!1);function E(e){return S.value.length<i.limit?S.value.push(e):a.warning(`最多允许上传${i.limit}个文件`),!1}function V(){c("on-cancel"),S.value=[]}function D(){0===S.value.length?a.error("请选择要上传的文件"):c("on-confirm",S.value)}return d((()=>i.dialogVisible),(e=>{k.value=e}),{immediate:!0}),(l,a)=>{const i=r("upload-filled"),c=t,u=n,d=r("CircleClose"),I=o,P=s;return f(),p(P,{modelValue:v(k),"onUpdate:modelValue":a[0]||(a[0]=e=>C(k)?k.value=e:null),title:e.title,width:e.width,modal:e.modal,draggable:e.draggable,"before-close":V},{footer:g((()=>[m("div",O,[h(I,{onClick:V},{default:g((()=>[y("取消")])),_:1}),h(I,{type:"primary",loading:e.loading,onClick:D},{default:g((()=>[y("确定")])),_:1},8,["loading"])])])),default:g((()=>[h(u,{multiple:e.multiple,limit:e.limit,drag:"",action:"",accept:e.accept,"before-upload":E,disabled:v(N)},{default:g((()=>[h(c,{class:"el-icon--upload"},{default:g((()=>[h(i)])),_:1}),B])),_:1},8,["multiple","limit","accept","disabled"]),v(S).length>0?(f(),b("ul",H,[(f(!0),b(x,null,_(v(S),(e=>(f(),b("li",{key:e.uid,class:"file-box"},[m("span",null,j(e.name),1),h(c,{class:"icon-del",size:"16px",onClick:l=>function(e){const l=S.value.findIndex((l=>l.uid===e.uid));-1!==l&&S.value.splice(l,1)}(e)},{default:g((()=>[h(d)])),_:2},1032,["onClick"])])))),128))])):w("",!0)])),_:1},8,["modelValue","title","width","modal","draggable"])}}}),I=c(D,[["__scopeId","data-v-d1d46af9"]]),P={class:"base-container container"},U={key:0,class:"tip"},$={key:1,class:"sheet-list"},z=["onClick"],A=Object.assign({name:"StudentClassHours"},{__name:"studentClassHours",setup(e){const l=u(!1),a=u(!1),t=u([]),n=[3,4,5,6,7,8,11,12,13,14,15,16,19,20,21,22,23,24,27,28,29,30,31,32,35,36,37,38,39,40,43,44,45,46,47,48];function s(){l.value=!0}function c(){l.value=!1}async function d(e){var n;a.value=!0,t.value=await(n=e[0],new Promise((e=>{const l=new FileReader;l.onload=l=>{const a=l.target.result,t=N(a,{type:"binary"});console.log("excel原始数据",t);const n=[];t.SheetNames.forEach((e=>{const l={sheetName:e,sheetData:E.sheet_to_json(t.Sheets[e])};n.push(l)})),console.log("json序列化后的excel数据",n),e(n)},l.readAsBinaryString(n)}))),a.value=!1,l.value=!1,1===t.value.length&&r(t.value[0])}function r(e){const l=[];e.sheetData.forEach((e=>{if(n.includes(e.__rowNum__))for(const a in e)a.includes("EMPTY")&&l.push(e[a])})),console.log("学生姓名和对应的课时数据",l);const a={};l.forEach(((e,t)=>{t%2==0&&(a[e]?a[e].classHours.push(l[t+1]):a[e]={name:e,classHours:[l[t+1]],sum:0})}));let t=0;for(const n in a)a[n].classHours.forEach((e=>{a[n].sum+=e})),t+=a[n].sum;console.log("按照学生姓名分组的课时数据",a),console.log("所有学生的合计课时数据",t);const o=Object.values(a).map(((e,l)=>{const a={"序号":String(l+1),"姓名":e.name,"总计":e.sum};return e.classHours.forEach(((e,l)=>{a[`第${l+1}节`]=e})),a})),s={"序号":"","姓名":"","总计":t};o.push(s),console.log("下载的数据格式",o),function(e,l){const a=`${l}.xlsx`,t="Sheet 1",n=E.book_new(),o=E.json_to_sheet(e);E.book_append_sheet(n,o,t),V(n,a)}(o,e.sheetName)}return(e,n)=>{const u=o,p=i,m=I;return f(),b("div",P,[h(p,{class:"card"},{default:g((()=>[h(u,{type:"primary",onClick:s},{default:g((()=>[y("上传文件")])),_:1}),v(t).length>1?(f(),b("p",U,"检测到存在多个Sheet页，请选择一个下载")):w("",!0),v(t).length>1?(f(),b("ul",$,[(f(!0),b(x,null,_(v(t),(e=>(f(),b("li",{key:e.sheetName,class:"sheet-item",onClick:l=>r(e)},j(e.sheetName),9,z)))),128))])):w("",!0)])),_:1}),h(m,{dialogVisible:v(l),accept:".xls,.xlsx",loading:v(a),onOnConfirm:d,onOnCancel:c},null,8,["dialogVisible","loading"])])}}});e("default",c(A,[["__scopeId","data-v-403fb5f1"]]))}}}));
