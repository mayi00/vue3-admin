import{ax as e,j as a,k as l,w as t,m as u,ac as o,aA as d,u as r,p as s,H as i,G as m,aK as n,A as p,ad as c,aL as v,C as b,ay as y,ab as V,a2 as f,r as g,x as _,E as T,a8 as h,aB as k,c as E}from"./DFilHWvT.js";import{a as U}from"./C762OUmN.js";import{a as M}from"./CxAYDShj.js";const A={__name:"menuFormDialog",props:{visible:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},menuData:{type:Object,default:()=>({})}},emits:["update:visible","success"],setup(A,{emit:I}){const L=A,x=I,N=g(null),w={id:"",parentId:"",menuType:"MENU",sort:1,visible:1,path:"",component:"",name:"",meta:{title:"",icon:"",link:"",keepAlive:!1}},q=g({}),D=_(()=>({menuType:[{required:!0,message:"请选择菜单类型",trigger:["change"]}],parentId:[{required:"MODULE"!==q.value.menuType,message:"请选择上级菜单",trigger:["change"]}],sort:[{required:!0,message:"请输入排序",trigger:["blur"]}],path:[{required:["MENU","IFRAME_LINK","EXT_LINK"].includes(q.value.menuType),message:"请输入路由路径",trigger:["blur"]}],component:[{required:"MENU"===q.value.menuType,message:"请输入组件路径",trigger:["blur"]}],name:[{required:"MENU"===q.value.menuType,message:"请输入菜单名称",trigger:["blur"]}],meta:{title:[{required:!0,message:"请输入菜单名称",trigger:["blur"]}],link:[{required:"IFRAME_LINK"===q.value.menuType,message:"请输入内链地址",trigger:["blur"]}]}})),O=g([]),C={label:e=>e.meta.title,value:"id"};e(()=>L.visible,e=>{e&&((async()=>{const e=await U.sys.menu.list();0===e.code&&(O.value=e.data)})(),L.isEdit?q.value=E(L.menuData):q.value=E(w))});const K=g(!1),j=()=>{N.value.validate(async e=>{if(e)try{if(K.value=!0,L.isEdit){const e=await U.sys.menu.update(q.value);0===e.code?T.success("编辑菜单成功"):T.error(e.message||"编辑菜单失败")}else{const e=await U.sys.menu.add(q.value);0===e.code?T.success("新增菜单成功"):T.error(e.message||"新增菜单失败")}x("success"),F()}catch(a){console.error("操作菜单失败:",a)}finally{K.value=!1}})},F=()=>{N.value?.resetFields(),x("update:visible",!1)};return(e,g)=>{const _=k,T=d,E=o,U=n,I=c,L=v,x=y,w=V,R=f,B=h;return a(),l(B,{"model-value":A.visible,title:A.isEdit?"编辑":"新增",width:"500px","close-on-click-modal":!1,onClose:F},{footer:t(()=>[u(R,{type:"primary",loading:r(K),onClick:j},{default:t(()=>[...g[13]||(g[13]=[b("确定",-1)])]),_:1},8,["loading"]),u(R,{onClick:F},{default:t(()=>[...g[14]||(g[14]=[b("取消",-1)])]),_:1})]),default:t(()=>[u(w,{ref_key:"formRef",ref:N,model:r(q),rules:r(D),"label-width":"100px"},{default:t(()=>[u(E,{label:"菜单类型",prop:"menuType"},{default:t(()=>[u(T,{modelValue:r(q).menuType,"onUpdate:modelValue":g[0]||(g[0]=e=>r(q).menuType=e),style:{width:"100%"},placeholder:"请选择菜单类型",clearable:""},{default:t(()=>[(a(!0),s(m,null,i(r(M)("MENU_TYPE"),e=>(a(),l(_,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),"MODULE"!==r(q).menuType?(a(),l(E,{key:0,label:"上级菜单",prop:"parentId"},{default:t(()=>[u(U,{modelValue:r(q).parentId,"onUpdate:modelValue":g[1]||(g[1]=e=>r(q).parentId=e),data:r(O),props:C,"render-after-expand":!1,"check-strictly":"",style:{width:"100%"},placeholder:"选择上级菜单",clearable:""},null,8,["modelValue","data"])]),_:1})):p("",!0),u(E,{label:"菜单名称",prop:"meta.title"},{default:t(()=>[u(I,{modelValue:r(q).meta.title,"onUpdate:modelValue":g[2]||(g[2]=e=>r(q).meta.title=e),placeholder:"请输入菜单名称",clearable:""},null,8,["modelValue"])]),_:1}),u(E,{label:"是否隐藏",prop:"visible"},{default:t(()=>[u(L,{modelValue:r(q).visible,"onUpdate:modelValue":g[3]||(g[3]=e=>r(q).visible=e),"inline-prompt":"","active-value":1,"inactive-value":0,"active-text":"显示","inactive-text":"隐藏"},null,8,["modelValue"])]),_:1}),u(E,{label:"访问路径",prop:"path"},{default:t(()=>[u(I,{modelValue:r(q).path,"onUpdate:modelValue":g[4]||(g[4]=e=>r(q).path=e),placeholder:"请输入访问路径",clearable:""},null,8,["modelValue"])]),_:1}),"MENU"===r(q).menuType?(a(),l(E,{key:1,label:"组件路径",prop:"component"},{default:t(()=>[u(I,{modelValue:r(q).component,"onUpdate:modelValue":g[5]||(g[5]=e=>r(q).component=e),placeholder:"请输入组件路径",clearable:""},{prepend:t(()=>[...g[11]||(g[11]=[b("src/views/",-1)])]),_:1},8,["modelValue"])]),_:1})):p("",!0),"IFRAME_LINK"===r(q).menuType?(a(),l(E,{key:2,label:"内链地址",prop:"meta.link"},{default:t(()=>[u(I,{modelValue:r(q).meta.link,"onUpdate:modelValue":g[6]||(g[6]=e=>r(q).meta.link=e),placeholder:"请输入内链",clearable:""},{prepend:t(()=>[...g[12]||(g[12]=[b("http://",-1)])]),_:1},8,["modelValue"])]),_:1})):p("",!0),"MODULE"!==r(q).menuType&&"CATALOG"!==r(q).menuType&&"EXT_LINK"!==r(q).menuType?(a(),l(E,{key:3,label:"路由 name",prop:"name"},{default:t(()=>[u(I,{modelValue:r(q).name,"onUpdate:modelValue":g[7]||(g[7]=e=>r(q).name=e),placeholder:"请输入路由名称",clearable:""},null,8,["modelValue"])]),_:1})):p("",!0),u(E,{label:"图标",prop:"meta.icon"},{default:t(()=>[u(I,{modelValue:r(q).meta.icon,"onUpdate:modelValue":g[8]||(g[8]=e=>r(q).meta.icon=e),placeholder:"请输入图标名称",clearable:""},null,8,["modelValue"])]),_:1}),"MODULE"!==r(q).menuType&&"CATALOG"!==r(q).menuType?(a(),l(E,{key:4,label:"缓存",prop:"meta.keepAlive"},{default:t(()=>[u(L,{modelValue:r(q).meta.keepAlive,"onUpdate:modelValue":g[9]||(g[9]=e=>r(q).meta.keepAlive=e),"inline-prompt":"","active-value":!0,"inactive-value":!1,"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"])]),_:1})):p("",!0),u(E,{label:"排序",prop:"sort"},{default:t(()=>[u(x,{modelValue:r(q).sort,"onUpdate:modelValue":g[10]||(g[10]=e=>r(q).sort=e),min:1,max:9999,precision:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value","title"])}}};export{A as default};
