import{_ as e}from"./DjzrIlqC.js";import{ao as a,g as l,j as t,p as n,m as o,w as s,ab as r,u as i,ag as u,ah as d,ac as p,ad as m,ar as c,aA as h,G as f,H as y,a2 as b,C as v,a1 as g,y as _,B as w,aM as T,aN as C,at as k,aO as N,au as x,D as M,a6 as j,r as E,W as V,E as U,k as P,aB as W}from"./DFilHWvT.js";import{_ as B,a as O}from"./C762OUmN.js";import{u as F}from"./5Ea9PFM7.js";import{b as I,a as J}from"./CxAYDShj.js";import K from"./6RnT-fH3.js";const L={class:"g-container"},S={class:"mb-[10px]"},z={class:"g-table-area"},A=B(Object.assign({name:"MenuManage"},{__name:"menuManage",setup(B){const{elementHeight:A}=F({offset:233}),H=I("MENU_TYPE"),R=E(null),Y=E({menuName:"",menuType:"",visible:""}),D=E({loading:!1,treeProps:{children:"children",hasChildren:"hasChildren"},data:[],columns:[{type:"index",label:"序号",minWidth:60},{prop:"meta.title",label:"菜单名称",minWidth:200},{prop:"menuType",label:"菜单类型",width:100,slot:"menuType"},{prop:"path",label:"路由路径",minWidth:200,slot:"path"},{prop:"component",label:"组件路径",minWidth:200,slot:"component"},{prop:"meta.icon",label:"图标",width:100},{prop:"visible",label:"是否隐藏",width:80,slot:"visible"},{prop:"sort",label:"排序",width:80},{prop:"operation",label:"操作",width:180,align:"center",fixed:"right",slot:"operation"}]}),G=a(()=>{Q()},300),q=()=>{R.value.resetFields(),G()},Q=async()=>{D.value.loading=!0;try{const e=await O.sys.menu.list();0===e.code?(D.value.data=e.data,D.value.data):U.error("获取菜单列表失败")}catch(e){console.error("获取菜单数据失败:",e),U.error("获取菜单数据失败")}finally{D.value.loading=!1}};l(()=>{G()});const X=E(!1),Z=E({}),$=E(!1),ee=()=>{$.value=!1,Z.value={},X.value=!0},ae=()=>{X.value=!1,Z.value={},$.value=!1,Q()},le=async({id:e})=>{try{const a=await O.sys.menu.delete({id:e});0===a.code?(U.success("删除成功"),Q()):U.error(a.message||"删除失败")}catch(a){console.error("删除菜单失败:",a),U.error("删除菜单失败")}};return(a,l)=>{const E=m,U=p,B=d,O=W,F=h,I=b,Q=u,te=r,ne=g,oe=w,se=x,re=k,ie=e;return t(),n("div",L,[o(ne,{shadow:"hover","body-style":"padding-bottom: 0"},{default:s(()=>[o(te,{ref_key:"searchFormRef",ref:R,model:i(Y),"label-width":"100px"},{default:s(()=>[o(Q,null,{default:s(()=>[o(B,{span:6},{default:s(()=>[o(U,{label:"菜单名称",prop:"menuName"},{default:s(()=>[o(E,{modelValue:i(Y).menuName,"onUpdate:modelValue":l[0]||(l[0]=e=>i(Y).menuName=e),placeholder:"请输入菜单名称",clearable:"",onKeyup:c(i(G),["enter"])},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),o(B,{span:6},{default:s(()=>[o(U,{label:"菜单类型",prop:"menuType"},{default:s(()=>[o(F,{modelValue:i(Y).menuType,"onUpdate:modelValue":l[1]||(l[1]=e=>i(Y).menuType=e),placeholder:"请选择菜单类型",clearable:"",onChange:i(G)},{default:s(()=>[(t(!0),n(f,null,y(i(J)("MENU_TYPE"),e=>(t(),P(O,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1}),o(B,{span:12,class:"pl-[10px]"},{default:s(()=>[o(I,{type:"primary",onClick:i(G)},{default:s(()=>[...l[3]||(l[3]=[v("查询",-1)])]),_:1},8,["onClick"]),o(I,{onClick:q},{default:s(()=>[...l[4]||(l[4]=[v("重置",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),o(ne,{shadow:"hover",style:{"margin-top":"10px"}},{default:s(()=>[_("div",S,[o(I,{type:"primary",onClick:ee},{default:s(()=>[o(oe,null,{default:s(()=>[o(i(T))]),_:1}),l[5]||(l[5]=v(" 新增菜单 ",-1))]),_:1})]),_("div",z,[o(ie,{height:i(A),loading:i(D).loading,data:i(D).data,columns:i(D).columns,"row-key":"id","tree-props":i(D).treeProps,showPagination:!1},{menuType:s(({row:e})=>[_("span",null,M(i(H).get(e.menuType)||"-"),1)]),path:s(({row:e})=>[_("span",null,M(["MENU","IFRAME_LINK"].includes(e.menuType)?e.path:"-"),1)]),component:s(({row:e})=>[_("span",null,M(["MENU"].includes(e.menuType)?e.component:"-"),1)]),visible:s(({row:e})=>[o(se,{type:e.visible?"success":"danger"},{default:s(()=>[v(M(e.visible?"显示":"隐藏"),1)]),_:2},1032,["type"])]),operation:s(({row:e})=>[o(I,{type:"primary",link:"",size:"small",onClick:a=>{return l=e,$.value=!0,Z.value=JSON.parse(JSON.stringify(l)),void(X.value=!0);var l}},{default:s(()=>[o(oe,null,{default:s(()=>[o(i(C))]),_:1}),l[6]||(l[6]=v("编辑 ",-1))]),_:1},8,["onClick"]),o(re,{title:"确定要删除该菜单吗？",width:"160",placement:"top","confirm-button-type":"danger",onConfirm:a=>{var l;(e=>e.children&&e.children.length>0)(l=e)?V.confirm("该菜单包含子菜单，确定要一并删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{le(l)}).catch(()=>{}):le(l)}},{reference:s(()=>[o(I,{type:"danger",link:"",size:"small"},{default:s(()=>[o(oe,null,{default:s(()=>[o(i(N))]),_:1}),l[7]||(l[7]=v("删除 ",-1))]),_:1})]),_:1},8,["onConfirm"])]),_:1},8,["height","loading","data","columns","tree-props"])]),o(K,{visible:i(X),"onUpdate:visible":l[2]||(l[2]=e=>j(X)?X.value=e:null),"is-edit":i($),"menu-data":i(Z),onSuccess:ae},null,8,["visible","is-edit","menu-data"])]),_:1})])}}}),[["__scopeId","data-v-338daeeb"]]);export{A as default};
