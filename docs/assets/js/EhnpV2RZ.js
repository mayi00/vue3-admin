import{ax as e,j as a,k as l,w as t,m as i,ab as s,ac as o,u as d,aH as r,aA as u,p as n,H as m,G as c,aa as p,C as f,D as g,a2 as v,r as b,d as T,E as y,a8 as _,aB as V}from"./OcaL6beW.js";import{_ as h}from"./Ci5orCBq.js";import{a as E}from"./CFdA1usV.js";import{a as Y}from"./CxAYDShj.js";const D={__name:"noticeFormDialog",props:{visible:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},noticeData:{type:Object,default:()=>({})}},emits:["update:visible","success"],setup(D,{emit:j}){const H=D,k=j,q=Y("NOTICE_TYPE"),w=b(null),x=b({id:"",title:"",noticeType:"",startTime:"",endTime:"",content:""}),C={title:[{required:!0,message:"请输入通知标题",trigger:"blur"}],noticeType:[{required:!0,message:"请选择通知类型",trigger:"change"}],startTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],endTime:[{validator:(e,a,l)=>{x.value.startTime,x.value.startTime&&a&&T(a).isBefore(T(x.value.startTime))?l("结束时间不能早于开始时间"):l()},trigger:"change"}],content:[{required:!0,message:"请输入通知内容",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]};e(()=>H.noticeData,e=>{e&&H.isEdit&&Object.assign(x.value,e)},{deep:!0,immediate:!0});const U=b(!1);function B(){w.value.validate(async e=>{if(e)try{U.value=!0,H.isEdit?(await E.sys.notice.edit(x.value),y.success("编辑成功")):(await E.sys.notice.add(x.value),y.success("新增成功")),k("success"),k("update:visible",!1)}catch(a){y.error(a.message||"操作失败，请重试")}finally{U.value=!1}})}function M(){w.value?.resetFields(),k("update:visible",!1)}return(e,b)=>{const T=o,y=s,E=r,Y=V,j=u,H=h,k=p,F=v,O=_;return a(),l(O,{"model-value":D.visible,title:D.isEdit?"编辑":"新增",width:"500px",onClose:M},{footer:t(()=>[i(F,{type:"primary",loading:d(U),onClick:B},{default:t(()=>[f(g(D.isEdit?"保存":"提交"),1)]),_:1},8,["loading"]),i(F,{onClick:M},{default:t(()=>[...b[5]||(b[5]=[f("取消",-1)])]),_:1})]),default:t(()=>[i(k,{ref_key:"noticeFormRef",ref:w,model:d(x),rules:C,"label-width":"110px"},{default:t(()=>[i(y,{label:"通知标题",prop:"title"},{default:t(()=>[i(T,{modelValue:d(x).title,"onUpdate:modelValue":b[0]||(b[0]=e=>d(x).title=e),placeholder:"请输入通知标题",maxlength:"50",clearable:""},null,8,["modelValue"])]),_:1}),i(y,{label:"通知开始时间",prop:"startTime"},{default:t(()=>[i(E,{modelValue:d(x).startTime,"onUpdate:modelValue":b[1]||(b[1]=e=>d(x).startTime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"请选择开始时间",clearable:""},null,8,["modelValue"])]),_:1}),i(y,{label:"通知结束时间",prop:"endTime"},{default:t(()=>[i(E,{modelValue:d(x).endTime,"onUpdate:modelValue":b[2]||(b[2]=e=>d(x).endTime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"请选择结束时间",clearable:""},null,8,["modelValue"])]),_:1}),i(y,{label:"通知类型",prop:"noticeType"},{default:t(()=>[i(j,{modelValue:d(x).noticeType,"onUpdate:modelValue":b[3]||(b[3]=e=>d(x).noticeType=e),disabled:D.isEdit,placeholder:"请选择通知类型",clearable:""},{default:t(()=>[(a(!0),n(c,null,m(d(q),e=>(a(),l(Y,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),i(y,{label:"通知内容",prop:"content"},{default:t(()=>[i(H,{value:d(x).content,"onUpdate:value":b[4]||(b[4]=e=>d(x).content=e),placeholder:"请输入通知内容"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["model-value","title"])}}};export{D as default};
