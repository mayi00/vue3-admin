import{_ as e}from"./C6eypMRw.js";import{_ as a}from"./DqK7WFuo.js";import{j as l,p as t,m as i,w as n,aa as o,u as s,af as u,ag as d,ab as r,ac as c,aA as p,aB as m,a2 as f,C as v,a1 as g,y,at as b,D as h,a6 as _,r as T,a9 as w,E as C}from"./OcaL6beW.js";import{a as x}from"./CFdA1usV.js";import{u as j}from"./BmeqqqNF.js";import k from"./EhnpV2RZ.js";import{b as P,a as z}from"./CxAYDShj.js";import"./Ci5orCBq.js";const S={class:"g-container"},U={class:"mb-[10px]"},V=Object.assign({name:"NoticeManage"},{__name:"index",setup(V){const W=T(null),E=w({title:"",noticeType:""}),I=P("NOTICE_TYPE");function N(){F.value.currentPage=1,Y()}function O(){W.value.resetFields(),N()}z("NOTICE_TYPE");const{elementHeight:R}=j({offset:275}),B=T(null),F=T({loading:!1,currentPage:1,pageSize:10,total:0,data:[],columns:[{type:"selection",width:50},{type:"index",label:"序号",minWidth:60,slot:"index"},{prop:"title",label:"通知标题",minWidth:120},{prop:"noticeType",label:"通知类型",minWidth:100,slot:"noticeType"},{prop:"startTime",label:"通知开始时间",minWidth:150},{prop:"endTime",label:"通知结束时间",minWidth:150},{prop:"createUser",label:"创建人",minWidth:100},{prop:"operation",label:"操作",width:180,align:"center",fixed:"right",slot:"operation"}]});function H(e){return F.value.pageSize*(F.value.currentPage-1)+e+1}function Y(){const e={currentPage:F.value.currentPage,pageSize:F.value.pageSize},a={...E};F.value.loading=!0,x.sys.notice.list(e,a).then(e=>{F.value.data=e.data.list,F.value.total=e.data.total}).catch(()=>{F.value.data=[],F.value.total=0}).finally(()=>{F.value.loading=!1})}function A(e){F.value.currentPage=e,Y()}function D(e){F.value.pageSize=e,Y()}const G=T(!1),J=T(!1),K=T({});function M(){J.value=!1,K.value={},G.value=!0}function q(){G.value=!1,K.value={},Y()}const L=T({ids:[],visible:!1,loading:!1});function Q(){const e=B.value?.getSelectionRows();if(!e.length)return C.warning("请选择数据");L.value.ids=e.map(e=>e.id),L.value.visible=!0}async function X(){L.value.loading=!0;try{await x.sys.notice.delete({ids:L.value.ids}),C({type:"success",message:"删除成功"}),L.value.visible=!1,L.value.loading=!1,Y()}finally{L.value.loading=!1}}function Z(){L.value.visible=!1,L.value.ids=[]}return Y(),(T,w)=>{const j=c,P=r,z=d,V=m,$=p,ee=f,ae=u,le=o,te=g,ie=b,ne=a,oe=e;return l(),t("div",S,[i(te,{shadow:"hover","body-style":"padding-bottom: 0"},{default:n(()=>[i(le,{ref_key:"searchFormRef",ref:W,model:s(E),"label-width":100},{default:n(()=>[i(ae,null,{default:n(()=>[i(z,{span:8},{default:n(()=>[i(P,{label:"通知标题",prop:"title"},{default:n(()=>[i(j,{modelValue:s(E).title,"onUpdate:modelValue":w[0]||(w[0]=e=>s(E).title=e),placeholder:"请输入通知标题",maxlength:"50",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),i(z,{span:8},{default:n(()=>[i(P,{label:"通知类型",prop:"noticeType"},{default:n(()=>[i($,{modelValue:s(E).noticeType,"onUpdate:modelValue":w[1]||(w[1]=e=>s(E).noticeType=e),placeholder:"请选择通知类型",clearable:""},{default:n(()=>[i(V,{label:"通知",value:"1"}),i(V,{label:"公告",value:"2"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),i(z,{span:8,class:"pl-[10px]"},{default:n(()=>[i(ee,{type:"primary",onClick:N},{default:n(()=>[...w[3]||(w[3]=[v("查询",-1)])]),_:1}),i(ee,{onClick:O},{default:n(()=>[...w[4]||(w[4]=[v("重置",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),i(te,{shadow:"hover",style:{"margin-top":"10px"}},{default:n(()=>[y("div",U,[i(ee,{type:"primary",onClick:M},{default:n(()=>[...w[5]||(w[5]=[v("新增",-1)])]),_:1}),i(ee,{type:"danger",onClick:Q},{default:n(()=>[...w[6]||(w[6]=[v("批量删除",-1)])]),_:1})]),i(ne,{ref_key:"hyTableRef",ref:B,height:s(R),loading:s(F).loading,data:s(F).data,columns:s(F).columns,total:s(F).total,"onUpdate:currentPage":A,"onUpdate:pageSize":D},{index:n(({index:e})=>[v(h(H(e)),1)]),noticeType:n(({row:e})=>[v(h(s(I).get(e.noticeType)||""),1)]),operation:n(({row:e})=>[i(ee,{type:"primary",link:"",size:"small",onClick:a=>function(e){J.value=!0,K.value={...e},G.value=!0}(e)},{default:n(()=>[...w[7]||(w[7]=[v("编辑",-1)])]),_:1},8,["onClick"]),i(ie,{title:"请确认是否删除？",width:"160",placement:"top","confirm-button-type":"danger",onConfirm:a=>async function(e){await x.sys.notice.delete({ids:[e.id]}),C({type:"success",message:"删除成功"}),Y()}(e)},{reference:n(()=>[i(ee,{type:"danger",link:"",size:"small"},{default:n(()=>[...w[8]||(w[8]=[v("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:1},8,["height","loading","data","columns","total"])]),_:1}),i(k,{visible:s(G),"onUpdate:visible":w[2]||(w[2]=e=>_(G)?G.value=e:null),"is-edit":s(J),"notice-data":s(K),onSuccess:q},null,8,["visible","is-edit","notice-data"]),i(oe,{visible:s(L).visible,title:"批量删除",loading:s(L).loading,confirmBtnType:"danger",onConfirm:X,onCancel:Z},null,8,["visible","loading"])])}}});export{V as default};
