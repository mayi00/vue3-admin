import{ax as e,j as a,k as l,w as s,m as o,ac as t,ad as r,u as d,a5 as u,p as i,H as m,G as n,ab as p,C as c,a2 as f,r as b,E as g,a8 as v,a7 as y,c as V}from"./DFilHWvT.js";import{a as _}from"./CxAYDShj.js";import{a as E}from"./C762OUmN.js";const k={__name:"roleFormDialog",props:{visible:{type:Boolean,required:!0},isEdit:{type:Boolean,default:!1},roleData:{type:Object,default:()=>({})}},emits:["update:visible","success"],setup(k,{emit:C}){const h=k,N=C,w=b(null),x=b(!1),j=b({id:"",roleCode:"",roleName:"",remark:"",status:"ENABLED"}),D={roleCode:[{required:!0,message:"请输入角色编码",trigger:"blur"}],roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]};function U(){w.value?.resetFields(),N("update:visible",!1)}async function q(){w.value.validate(async e=>{if(e)try{const e={...j.value};x.value=!0,h.isEdit?await E.sys.role.edit(e):await E.sys.role.add(e),g.success((h.isEdit?"编辑":"新增")+"成功"),U(),N("success")}catch(a){console.error(a),g.error(`${h.isEdit?"编辑":"新增"}失败：${a.message||"未知错误"}`)}finally{x.value=!1}})}return e(()=>h.roleData,e=>{h.isEdit&&(j.value=V(e))},{deep:!0,immediate:!0}),(e,b)=>{const g=r,V=t,E=y,C=u,h=p,N=f,B=v;return a(),l(B,{"model-value":k.visible,title:k.isEdit?"编辑角色":"新增角色",width:"480px",onClose:U},{footer:s(()=>[o(N,{type:"primary",loading:d(x),onClick:q},{default:s(()=>[...b[4]||(b[4]=[c("确认",-1)])]),_:1},8,["loading"]),o(N,{onClick:U},{default:s(()=>[...b[5]||(b[5]=[c("取消",-1)])]),_:1})]),default:s(()=>[o(h,{ref_key:"roleFormRef",ref:w,model:d(j),"label-width":"80px",rules:D},{default:s(()=>[o(V,{label:"角色名称",prop:"roleName"},{default:s(()=>[o(g,{modelValue:d(j).roleName,"onUpdate:modelValue":b[0]||(b[0]=e=>d(j).roleName=e),placeholder:"请输入角色名称",clearable:""},null,8,["modelValue"])]),_:1}),o(V,{label:"角色编码",prop:"roleCode"},{default:s(()=>[o(g,{modelValue:d(j).roleCode,"onUpdate:modelValue":b[1]||(b[1]=e=>d(j).roleCode=e),placeholder:"请输入角色编码",disabled:k.isEdit,clearable:""},null,8,["modelValue","disabled"])]),_:1}),o(V,{label:"状态",prop:"status"},{default:s(()=>[o(C,{modelValue:d(j).status,"onUpdate:modelValue":b[2]||(b[2]=e=>d(j).status=e)},{default:s(()=>[(a(!0),i(n,null,m(d(_)("SYS_ENABLED_STATUS"),e=>(a(),l(E,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(V,{label:"备注",prop:"remark"},{default:s(()=>[o(g,{modelValue:d(j).remark,"onUpdate:modelValue":b[3]||(b[3]=e=>d(j).remark=e),placeholder:"请输入备注",type:"textarea",rows:3,maxlength:"50",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["model-value","title"])}}};export{k as default};
