import{ao as a,g as e,j as t,p as l,m as i,w as s,ap as d,aq as r,u as o,k as u,ad as n,ar as c,a6 as p,B as v,as as m,a1 as g,a2 as h,C as y,at as f,au as b,D as _,y as k,r as w,av as V,E as D,aw as S}from"./DFilHWvT.js";import{_ as C}from"./DjzrIlqC.js";import{_ as j,a as z}from"./C762OUmN.js";import{u as L}from"./5Ea9PFM7.js";import{g as x}from"./CxAYDShj.js";import E from"./YsdrsY1S.js";const P={class:"g-container dict-data-container"},W={class:"w-full h-full"},T={class:"card-header"},U=j(Object.assign({name:"DictData"},{__name:"dictData",setup(j){const U=w(!1),A=w([]),B=w({}),N=w(""),K=w([]),{elementHeight:M}=L({offset:227}),q=w({loading:!1,currentPage:1,pageSize:10,total:0,data:[],columns:[{type:"index",label:"序号",minWidth:60,slot:"index"},{prop:"dictLabel",label:"字典名称",minWidth:100},{prop:"dictValue",label:"字典值",minWidth:100},{prop:"sort",label:"排序",minWidth:80},{prop:"status",label:"状态",minWidth:80,slot:"status"},{prop:"remark",label:"备注",minWidth:100},{prop:"operation",label:"操作",width:120,align:"center",fixed:"right",slot:"operation"}]}),F=w(!1),H=w(!1),I=w({}),J=async()=>{U.value=!0;try{const a=await z.sys.dict.list();U.value=!1,A.value=a.data.list||[],K.value=[...A.value],A.value.length>0&&(B.value=A.value[0],Y())}catch(a){console.error("获取字典类型列表失败:",a),U.value=!1,A.value=[],K.value=[]}},O=a(a=>{K.value=a?A.value.filter(e=>e.dictLabel.includes(a)||e.dictValue.includes(a)):[...A.value]},300),R=a=>{B.value=a,q.value.currentPage=1,Y()},Y=async()=>{if(!B.value.dictValue)return q.value.data=[],void(q.value.total=0);try{q.value.loading=!0;const a=await z.sys.dict.dataList({dictType:B.value.dictValue,currentPage:q.value.currentPage,pageSize:q.value.pageSize});q.value.data=a.data.list||[],q.value.total=a.data.total||0}catch(a){console.error("获取字典数据列表失败:",a),q.value.data=[],q.value.total=0}finally{q.value.loading=!1}},G=a=>{q.value.currentPage=a,Y()},Q=a=>{q.value.pageSize=a,Y()},X=a=>q.value.pageSize*(q.value.currentPage-1)+a+1,Z=()=>{H.value=!1,I.value={},F.value=!0},$=()=>{F.value=!1,I.value={},J()};return e(()=>{J()}),(a,e)=>{const w=v,j=n,L=V,A=S,J=g,aa=h,ea=b,ta=f,la=C,ia=r;return t(),l("div",P,[i(J,{shadow:"hover",class:"dict-type-card g-children-thin-scrollbar"},{header:s(()=>[i(j,{modelValue:o(N),"onUpdate:modelValue":e[0]||(e[0]=a=>p(N)?N.value=a:null),modelModifiers:{trim:!0},placeholder:"搜索字典类型",clearable:"",style:{width:"100%"},onKeyup:c(o(O),["enter"]),onChange:o(O)},{prefix:s(()=>[i(w,null,{default:s(()=>[i(o(m))]),_:1})]),_:1},8,["modelValue","onKeyup","onChange"])]),default:s(()=>[d((t(),l("div",W,[o(K).length?(t(),u(L,{key:0,data:o(K),props:{label:"dictLabel",value:"dictValue"},"highlight-current":!0,"node-key":"dictValue","current-node-key":o(B).dictValue,onNodeClick:R},null,8,["data","current-node-key"])):(t(),u(A,{key:1,description:"暂无数据"}))])),[[ia,o(U)]])]),_:1}),i(J,{shadow:"hover",class:"dict-data-card"},{header:s(()=>[k("div",T,[k("span",null,"字典类型："+_(o(B).dictLabel||"--"),1),i(aa,{type:"primary",disabled:!o(B).dictValue,onClick:Z},{default:s(()=>[...e[2]||(e[2]=[y("新增字典",-1)])]),_:1},8,["disabled"])])]),default:s(()=>[o(B).dictValue?(t(),u(la,{key:0,height:o(M),loading:o(q).loading,data:o(q).data,columns:o(q).columns,total:o(q).total,"onUpdate:currentPage":G,"onUpdate:pageSize":Q},{index:s(({index:a})=>[y(_(X(a)),1)]),status:s(({row:a})=>[i(ea,{type:"ENABLED"===a.status?"success":"danger",effect:"dark"},{default:s(()=>[y(_(o(x)("SYS_ENABLED_STATUS",a.status)),1)]),_:2},1032,["type"])]),operation:s(({row:a})=>[i(aa,{type:"primary",link:"",size:"small",onClick:e=>(a=>{H.value=!0,I.value={...a},F.value=!0})(a)},{default:s(()=>[...e[3]||(e[3]=[y("编辑",-1)])]),_:1},8,["onClick"]),i(ta,{title:"请确认是否删除？",width:"160",placement:"top","confirm-button-type":"danger",onConfirm:e=>(async({id:a})=>{try{await z.sys.dict.deleteDictData({id:a}),D.success("删除成功"),Y()}catch(e){console.error("删除字典数据失败:",e),D.error("删除失败")}})(a)},{reference:s(()=>[i(aa,{type:"danger",link:"",size:"small"},{default:s(()=>[...e[4]||(e[4]=[y("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:1},8,["height","loading","data","columns","total"])):(t(),u(A,{key:1,description:"请选择字典类型"}))]),_:1}),i(E,{ref:"dictDataFormRef",visible:o(F),"onUpdate:visible":e[1]||(e[1]=a=>p(F)?F.value=a:null),isEdit:o(H),dictType:o(B),dictData:o(I),onSuccess:$},null,8,["visible","isEdit","dictType","dictData"])])}}}),[["__scopeId","data-v-8ec92fc1"]]);export{U as default};
