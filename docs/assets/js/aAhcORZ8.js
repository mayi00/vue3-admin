import{ax as e,j as a,k as l,w as t,m as s,ab as d,ac as r,u,a5 as o,p as i,H as m,G as n,aa as p,C as c,a2 as g,r as b,E as f,a8 as V,az as _,c as v}from"./OcaL6beW.js";import{_ as y,a as E}from"./CFdA1usV.js";import{a as h}from"./CxAYDShj.js";const x=y({__name:"userFormDialog",props:{visible:{type:Boolean,required:!0},isEdit:{type:Boolean,default:!1},userData:{type:Object,default:()=>({})}},emits:["update:visible","success"],setup(y,{emit:x}){const k=y,U=x,w=h("GENDER"),D=h("SYS_ENABLED_STATUS"),j=b(),q=b({id:"",avatar:"",account:"",name:"",gender:"",mobile:"",email:"",status:"ENABLED",remark:""}),B={account:[{required:!0,message:"请输入登录帐号",trigger:"blur"},{min:4,max:20,message:"请输入4-20位登录帐号",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:20,message:"2-20个字符",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],mobile:[{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]},C=b(!1);e(()=>k.userData,e=>{k.isEdit&&e&&(q.value=v(e))},{immediate:!0,deep:!0});const L=()=>{j.value?.resetFields(),U("update:visible",!1)},R=async()=>{j.value.validate(async e=>{if(e)try{const e={...q.value};C.value=!0,k.isEdit?await E.sys.user.edit(e):await E.sys.user.add(e),f.success((k.isEdit?"操作":"新增")+"成功"),L(),U("success")}catch(a){console.error(a),f.error(`${k.isEdit?"编辑":"新增"}失败：${a.message||"未知错误"}`)}finally{C.value=!1}})};return(e,b)=>{const f=r,v=d,E=_,h=o,x=p,k=g,U=V;return a(),l(U,{"model-value":y.visible,title:y.isEdit?"编辑":"新增",width:500,onClose:L},{footer:t(()=>[s(k,{type:"primary",loading:u(C),onClick:R},{default:t(()=>[...b[7]||(b[7]=[c("确定",-1)])]),_:1},8,["loading"]),s(k,{onClick:L},{default:t(()=>[...b[8]||(b[8]=[c("取消",-1)])]),_:1})]),default:t(()=>[s(x,{ref_key:"formRef",ref:j,model:u(q),rules:B,"label-width":"100px"},{default:t(()=>[s(v,{label:"登录帐号",prop:"account"},{default:t(()=>[s(f,{modelValue:u(q).account,"onUpdate:modelValue":b[0]||(b[0]=e=>u(q).account=e),modelModifiers:{trim:!0},disabled:y.isEdit,placeholder:"请输入登录帐号",maxlength:"20"},null,8,["modelValue","disabled"])]),_:1}),s(v,{label:"姓名",prop:"name"},{default:t(()=>[s(f,{modelValue:u(q).name,"onUpdate:modelValue":b[1]||(b[1]=e=>u(q).name=e),modelModifiers:{trim:!0},placeholder:"请输入姓名",maxlength:"20"},null,8,["modelValue"])]),_:1}),s(v,{label:"性别",prop:"gender"},{default:t(()=>[s(h,{modelValue:u(q).gender,"onUpdate:modelValue":b[2]||(b[2]=e=>u(q).gender=e)},{default:t(()=>[(a(!0),i(n,null,m(u(w),e=>(a(),l(E,{key:e.dictValue,value:e.dictValue,label:e.dictLabel},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(v,{label:"手机号",prop:"mobile"},{default:t(()=>[s(f,{modelValue:u(q).mobile,"onUpdate:modelValue":b[3]||(b[3]=e=>u(q).mobile=e),modelModifiers:{trim:!0},placeholder:"请输入手机号",maxlength:"11"},null,8,["modelValue"])]),_:1}),s(v,{label:"邮箱",prop:"email"},{default:t(()=>[s(f,{modelValue:u(q).email,"onUpdate:modelValue":b[4]||(b[4]=e=>u(q).email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),s(v,{label:"状态",prop:"status"},{default:t(()=>[s(h,{modelValue:u(q).status,"onUpdate:modelValue":b[5]||(b[5]=e=>u(q).status=e)},{default:t(()=>[(a(!0),i(n,null,m(u(D),e=>(a(),l(E,{key:e.dictValue,value:e.dictValue,label:e.dictLabel},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(v,{label:"备注",prop:"remark"},{default:t(()=>[s(f,{modelValue:u(q).remark,"onUpdate:modelValue":b[6]||(b[6]=e=>u(q).remark=e),type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入备注",maxlength:"200",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["model-value","title"])}}},[["__scopeId","data-v-e5855fa1"]]);export{x as default};
